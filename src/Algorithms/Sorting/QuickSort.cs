namespace Algorithms.Sorting;

internal static class QuickSort
{
    /// <summary>
    ///     <code>
    ///                           +-------+
    ///                           V       V
    ///                +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///     STEP 1     | -11 | |  12 | | -42 | |   0 | |   1 | |  90 | |  68 | |   6 | I  -9 I
    ///                +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///     
    ///                                   +-----------------------------------------------+ 
    ///                                   V                                               V
    ///                +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///     STEP 2     | -11 | | -42 | |  12 | |   0 | |   1 | |  90 | |  68 | |   6 | I  -9 I
    ///                +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///     
    ///                +-----+ +-----+ +=====+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+
    ///     STEP 3     | -11 | | -42 | I  -9 I |   0 | |   1 | |  90 | |  68 | |   6 | |  12 |
    ///                +-----+ +-----+ +=====+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+
    ///                                   |       |       |       |       |       |       |
    ///                   +-------+       |       |       |       |       |       |       |
    ///                   V       V       |       |       |       |       |       |       |
    ///                +-----+ +=====+    |       |       |       |       |       |       |
    ///     STEP 4     | -11 | I -42 I    |       |       |       |       |       |       |
    ///                +-----+ +=====+    |       |       |       |       |       |       |
    ///                                   |       |       |       |       |       |       |
    ///                +=====+ +-----+    |       |       |       |       |       |       |
    ///     STEP 5     I -42 I | -11 |    |       |       |       |       |       |       |
    ///                +=====+ +-----+    |       |       |       |       |       |       |
    ///                   |               |       |       |       |       |       |       |
    ///                   |    +=====+    |       |       |       |       |       |       |
    ///     STEP 6        |    I -11 I    |       |       |       |       |       |       |
    ///                   |    +=====+    |       |       |       |       |       |       |
    ///                   |       |       |       |       |       |       |       |       |
    ///                   |       |       |       |       |       V       |       V       |
    ///                   |       |       |       |       |       +---------------+       |
    ///                   |       |       |       V       V       V       V       V       V
    ///                   |       |       |    +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///     STEP 7        |       |       |    |   0 | |   1 | |  90 | |  68 | |   6 | I  12 I
    ///                   |       |       |    +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///                   |       |       |
    ///                   |       |       |                               +---------------+
    ///                   |       |       |                               V               V
    ///                   |       |       |    +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///     STEP 8        |       |       |    |   0 | |   1 | |   6 | |  68 | |  90 | I  12 I
    ///                   |       |       |    +-----+ +-----+ +-----+ +-----+ +-----+ +=====+
    ///                   |       |       |
    ///                   |       |       |    +-----+ +-----+ +-----+ +=====+ +-----+ +-----+
    ///     STEP 9        |       |       |    |   0 | |   1 | |   6 | I  12 I |  90 | |  68 |
    ///                   |       |       |    +-----+ +-----+ +-----+ +=====+ +-----+ +-----+
    ///                   |       |       |                               |       |       |
    ///                   |       |       |    +-----+ +-----+ +=====+    |       |       |
    ///     STEP 10       |       |       |    |   0 | |   1 | I   6 I    |       |       |
    ///                   |       |       |    +-----+ +-----+ +=====+    |       |       |
    ///                   |       |       |                       |       |       |       |
    ///                   |       |       |    +-----+ +=====+    |       |       |       |
    ///     STEP 11       |       |       |    |   0 | I   1 I    |       |       |       |
    ///                   |       |       |    +-----+ +=====+    |       |       |       |
    ///                   |       |       |               |       |       |       |       |
    ///                   |       |       |    +=====+    |       |       |       |       |
    ///     STEP 12       |       |       |    I   0 I    |       |       |       |       |
    ///                   |       |       |    +=====+    |       |       |       |       |
    ///                   |       |       |       |       |       |       |       V       V
    ///                   |       |       |       |       |       |       |       +-------+
    ///                   |       |       |       |       |       |       |       V       V
    ///                   |       |       |       |       |       |       |    +-----+ +=====+
    ///     STEP 13       |       |       |       |       |       |       |    |  90 | I  68 I
    ///                   |       |       |       |       |       |       |    +-----+ +=====+
    ///                   |       |       |       |       |       |       |
    ///                   |       |       |       |       |       |       |    +=====+ +-----+
    ///     STEP 14       |       |       |       |       |       |       |    I  68 I |  90 |
    ///                   |       |       |       |       |       |       |    +=====+ +-----+
    ///                   |       |       |       |       |       |       |       |
    ///                   |       |       |       |       |       |       |       |    +=====+
    ///     STEP 15       |       |       |       |       |       |       |       |    I  90 I
    ///                   |       |       |       |       |       |       |       |    +=====+
    ///                   |       |       |       |       |       |       |       |       |
    ///                   |       |       |       |       |       |       |       |       |
    ///                   V       V       V       V       V       V       V       V       V
    ///                +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+
    ///     STEP 16    | -42 | | -11 | |  -9 | |   0 | |   1 | |   6 | |  12 | |  68 | |  90 |
    ///                +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+ +-----+
    ///     </code>
    /// </summary>
    /// <param name="a"></param>
    public static void Sort(int[] a)
    {
        SortPart(a, 0, a.Length - 1);
    }

    private static void SortPart(int[] a, int lower, int upper)
    {
        if (lower >= upper) return;

        int pivot = a[upper];
        int j = lower - 1;

        for (int i = lower; i < upper; i++)
        {
            if (a[i] < pivot)
            {
                j++;
                (a[j], a[i]) = (a[i], a[j]);
            }
        }

        int p = j + 1;
        (a[p], a[upper]) = (a[upper], a[p]);

        SortPart(a, lower, p - 1);
        SortPart(a, p + 1, upper);
    }
}
